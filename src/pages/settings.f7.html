
<template>
    <div class="page">
        <div class="navbar">
            <div class="navbar navbar-bg"></div>
            <div class="navbar-inner sliding">
              <div class="left">
                <a href="#" class="link back">
                  <i class="icon icon-back"></i>
                  <span class="if-not-md">Back</span>
                </a>
              </div>
              <div class="title">Settings</div>
            </div>
          </div>

            <div class="page-content">
                <div class="list no-hairlines-md margin-top-half">
                    <div class="block-title text-color-black no-margin-bottom margin-left-half no-padding-bottom margin-top-half">Company Name and Address</div>
                    <div class="block-header no-margin-vertical margin-horizontal-half no-padding-horizontal">The information is used for invoicing!</div>
                    <ul>
                    <li class="item-content item-input">
                        <div class="item-inner">
                          <div class="item-title item-label">Company Name</div>
                          <div class="item-input-wrap">
                            <input id="companyname" type="text" class="settingsInput" placeholder="Company Name">
                          </div>
                        </div>
                      </li>
                      <li class="item-content item-input">
                        <div class="item-inner">
                          <div class="item-title item-label">Company Address</div>
                          <div class="item-input-wrap">
                            <textarea class="settingsInput" id="companyaddress" placeholder="Company Address"></textarea>
                            <!--<input id="companyaddress" type="text" placeholder="Company Address">-->
                          </div>
                        </div>
                      </li>
                      <li class="item-content item-input">
                        <div class="item-inner">
                          <div class="item-input-wrap">
                            <a id="savecompanyinfo" class="button button-fill button-raised bg-color-green" @click="savecompanyinfo">Save Info</a>
                          </div>
                        </div>
                      </li>
                    </ul>

                    <div class="block-title text-color-black no-margin-bottom margin-left-half padding-bottom-half margin-top-half">Choose currency</div>
                    <ul>
                      <li class="item-content item-input">
                        <div class="item-inner">
                          <div class="item-title item-label">Currency</div>
                          <div class="item-input-wrap">
                            <input id="autocomplete-dropdown-all" class="settingsInput" type="text" placeholder="Currency">
                          </div>
                        </div>
                      </li>
                    </ul>

                </div>
            </div>
  
    </div> 
  </template>
  <script>
      import currencies from '../js/currencies.js';
    export default {
      data() {
        return {
          user: {
            firstName: 'John',
            lastName: 'Doe',
          },
          // Login screen demo data
          username: '',
          password: '',
  
        };
      },
      methods: {
        helloWorld() {
          this.$f7.dialog.alert('Hello World!');
        },
        showToast: function(text, position){
        var self = this;
        self.$app.toast.create({
                        text: text,
                        position: position,
                        closeTimeout: 2000,
                        }).open();
        },
        savecompanyinfo: function(){
            var self = this;
            var comName = $("#companyname").val().trim();
            if(comName != ""){
                localStorage.setItem("companyName", comName);
            }
            var comAdd = $("#companyaddress").val().trim();
            if(comAdd != ""){
                localStorage.setItem("companyAddress", comAdd);
            }
            if(comName != "" || comAdd != ""){
                self.showToast("Information Saved!", "center");
            }
        }
      },
      on: {
      pageInit: function(e, page) {
            var self = this;
            var comName = localStorage.getItem("companyName");
            if(comName != undefined){
                $("#companyname").val(comName);
            }
            var comAdd = localStorage.getItem("companyAddress");
            if(comAdd != undefined){
                $("#companyaddress").val(comAdd);
            }
            var savedCurr = localStorage.getItem("currency");
            if(savedCurr != undefined){
                $('#autocomplete-dropdown-all').val(savedCurr);
            }
            var cur = Object.keys(currencies);
            var autocompleteDropdownAll = self.$app.autocomplete.create({
                inputEl: '#autocomplete-dropdown-all',
                openIn: 'dropdown',
                source: function (query, render) {
                    var results = [];
                    // Find matched items
                    for (var i = 0; i < cur.length; i++) {
                    if (cur[i].toLowerCase().indexOf(query.toLowerCase()) >= 0) results.push(cur[i]);
                    }
                    // Render items by passing array with result items
                    render(results);
                    },
                on:{
                    change: function (value) {
                        var cnt = value[0];
                        var val = currencies[cnt];
                        $('#autocomplete-dropdown-all').val(val);
                        localStorage.setItem("currency", val);
                    }     
                }
                });
            }  
        }
    }
  </script>
  